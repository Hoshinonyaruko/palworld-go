import{c as q,u as M,e as N,h as R,v as T,f as B,Q as E}from"./QBtn.a7ccbd1a.js";import{u as U,a as K,b as O,Q as I,c as P,d as H,e as W}from"./QPage.4a7534e6.js";import{c as b,h as V,g as z,r as x,P as X,S as Y,U as Z,o as j,H as A,M as G,V as J,i as ee,W as te,_ as oe,d as ae,X as ne,m as se,n as ue,p as d,f as s,t as re,q as S,Y as ie,Z as D}from"./index.f65501bb.js";const le={true:"inset",item:"item-inset","item-thumbnail":"item-thumbnail-inset"},F={xs:2,sm:4,md:8,lg:16,xl:24};var L=q({name:"QSeparator",props:{...U,spaced:[Boolean,String],inset:[Boolean,String],vertical:Boolean,color:String,size:String},setup(e){const g=z(),r=K(e,g.proxy.$q),i=b(()=>e.vertical===!0?"vertical":"horizontal"),a=b(()=>` q-separator--${i.value}`),u=b(()=>e.inset!==!1?`${a.value}-${le[e.inset]}`:""),l=b(()=>`q-separator${a.value}${u.value}`+(e.color!==void 0?` bg-${e.color}`:"")+(r.value===!0?" q-separator--dark":"")),h=b(()=>{const f={};if(e.size!==void 0&&(f[e.vertical===!0?"width":"height"]=e.size),e.spaced!==!1){const _=e.spaced===!0?`${F.md}px`:e.spaced in F?`${F[e.spaced]}px`:e.spaced,n=e.vertical===!0?["Left","Right"]:["Top","Bottom"];f[`margin${n[0]}`]=f[`margin${n[1]}`]=_}return f});return()=>V("hr",{class:l.value,style:h.value,"aria-orientation":i.value})}}),ce=q({name:"QCardActions",props:{...M,vertical:Boolean},setup(e,{slots:g}){const r=N(e),i=b(()=>`q-card__actions ${r.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>V("div",{class:i.value},R(g.default))}}),de=q({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:g,emit:r}){const i=z(),a=x(null);let u=0;const l=[];function h(t){const p=typeof t=="boolean"?t:e.noErrorFocus!==!0,C=++u,$=(o,c)=>{r("validation"+(o===!0?"Success":"Error"),c)},Q=o=>{const c=o.validate();return typeof c.then=="function"?c.then(m=>({valid:m,comp:o}),m=>({valid:!1,comp:o,err:m})):Promise.resolve({valid:c,comp:o})};return(e.greedy===!0?Promise.all(l.map(Q)).then(o=>o.filter(c=>c.valid!==!0)):l.reduce((o,c)=>o.then(()=>Q(c).then(m=>{if(m.valid===!1)return Promise.reject(m)})),Promise.resolve()).catch(o=>[o])).then(o=>{if(o===void 0||o.length===0)return C===u&&$(!0),!0;if(C===u){const{comp:c,err:m}=o[0];if(m!==void 0&&console.error(m),$(!1,c),p===!0){const k=o.find(({comp:w})=>typeof w.focus=="function"&&T(w.$)===!1);k!==void 0&&k.comp.focus()}}return!1})}function f(){u++,l.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function _(t){t!==void 0&&A(t);const p=u+1;h().then(C=>{p===u&&C===!0&&(e.onSubmit!==void 0?r("submit",t):t!==void 0&&t.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function n(t){t!==void 0&&A(t),r("reset"),G(()=>{f(),e.autofocus===!0&&e.noResetFocus!==!0&&v()})}function v(){O(()=>{if(a.value===null)return;const t=a.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||a.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||a.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(a.value.querySelectorAll("[tabindex]"),p=>p.tabIndex>-1);t!=null&&t.focus({preventScroll:!0})})}X(J,{bindComponent(t){l.push(t)},unbindComponent(t){const p=l.indexOf(t);p>-1&&l.splice(p,1)}});let y=!1;return Y(()=>{y=!0}),Z(()=>{y===!0&&e.autofocus===!0&&v()}),j(()=>{e.autofocus===!0&&v()}),Object.assign(i.proxy,{validate:h,resetValidation:f,submit:_,reset:n,focus:v,getValidationComponents:()=>l}),()=>V("form",{class:"q-form",ref:a,onSubmit:_,onReset:n},R(g.default))}});function fe(){return ee(te)}const ve={class:"text-h5"},me=ae({__name:"LoginView",setup(e){const g=ne(),r=x(!1),i=x(""),a=x(""),u=x(""),l=fe();async function h(){try{const n=await D.checkLoginStatus();r.value=n.isLoggedIn,r.value&&g.push("/index")}catch(n){console.error("Error checking login status:",n),r.value=!1}}function f(){i.value="",a.value=""}async function _(){if(!(!i.value||!a.value))try{(await D.loginApi(i.value,a.value)).isLoggedIn?(r.value=!0,g.push("/index")):(u.value="\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7528\u6237\u540D\u548C\u5BC6\u7801\u3002",l.notify({color:"negative",position:"top",message:u.value,icon:"report_problem"}))}catch{u.value="\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7528\u6237\u540D\u548C\u5BC6\u7801\u3002",l.notify({color:"negative",position:"top",message:u.value,icon:"report_problem"})}}return j(()=>{h().catch(n=>{console.error("Failed to check login status:",n)})}),(n,v)=>(se(),ue(W,{class:"row justify-center"},{default:d(()=>[s(H,{class:"col-12 col-xs-8 col-sm-6 col-md-4 shadow q-pa-md self-center"},{default:d(()=>[s(I,null,{default:d(()=>[re("div",ve,[s(B,{name:"login",color:"accent"}),S(" \u767B\u5F55")])]),_:1}),s(L),s(de,{autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false",onSubmit:ie(_,["prevent"]),onReset:f},{default:d(()=>[s(I,{class:"q-gutter-md"},{default:d(()=>[s(P,{modelValue:i.value,"onUpdate:modelValue":v[0]||(v[0]=y=>i.value=y),filled:"",clearable:"",label:"\u7528\u6237\u540D",required:""},{prepend:d(()=>[s(B,{name:"person"})]),_:1},8,["modelValue"]),s(P,{modelValue:a.value,"onUpdate:modelValue":v[1]||(v[1]=y=>a.value=y),type:"password",filled:"",clearable:"",label:"\u5BC6\u7801",required:""},{prepend:d(()=>[s(B,{name:"lock"})]),_:1},8,["modelValue"])]),_:1}),s(L),s(ce,{class:"justify-center"},{default:d(()=>[s(E,{flat:"",color:"positive",type:"submit",icon:"check"},{default:d(()=>[S("\u767B\u5F55")]),_:1}),s(E,{flat:"",color:"negative",type:"reset",icon:"clear"},{default:d(()=>[S("\u6E05\u9664")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});var ye=oe(me,[["__scopeId","data-v-7977d987"]]);export{ye as default};
